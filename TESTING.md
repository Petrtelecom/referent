# План тестирования функций AI-обработки

## Этап 4: Тестирование

### 4.1. Функциональное тестирование

#### Тест 1: Кнопка "О чем статья?" (summary)

**Предварительные условия:**
- Введен валидный URL англоязычной статьи
- API ключ OpenRouter настроен

**Шаги:**
1. Ввести URL статьи в поле ввода
2. Нажать кнопку "О чем статья?"
3. Дождаться завершения обработки

**Ожидаемый результат:**
- ✅ Статья автоматически парсится (если не была распарсена ранее)
- ✅ Отображается индикатор загрузки "Обработка..."
- ✅ В блоке результатов появляется краткое описание статьи на русском языке (2-3 абзаца)
- ✅ Описание содержит основные темы, идеи и выводы статьи
- ✅ Результат можно скопировать кнопкой "Копировать"

**Проверка форматирования:**
- ✅ Текст читаемый и структурированный
- ✅ Нет технических артефактов или кода

---

#### Тест 2: Кнопка "Тезисы" (theses)

**Предварительные условия:**
- Введен валидный URL англоязычной статьи
- API ключ OpenRouter настроен

**Шаги:**
1. Ввести URL статьи в поле ввода
2. Нажать кнопку "Тезисы"
3. Дождаться завершения обработки

**Ожидаемый результат:**
- ✅ Статья автоматически парсится
- ✅ Отображается индикатор загрузки
- ✅ В блоке результатов появляются структурированные тезисы на русском языке
- ✅ Тезисы представлены в виде списка с пунктами и подпунктами
- ✅ Каждый тезис краткий и информативный

**Проверка форматирования:**
- ✅ Используется формат списка (маркированный или нумерованный)
- ✅ Есть иерархия (основные пункты и подпункты)
- ✅ Текст читаемый

---

#### Тест 3: Кнопка "Пост для Telegram" (telegram-post)

**Предварительные условия:**
- Введен валидный URL англоязычной статьи
- API ключ OpenRouter настроен

**Шаги:**
1. Ввести URL статьи в поле ввода
2. Нажать кнопку "Пост для Telegram"
3. Дождаться завершения обработки

**Ожидаемый результат:**
- ✅ Статья автоматически парсится
- ✅ Отображается индикатор загрузки
- ✅ В блоке результатов появляется пост для Telegram на русском языке
- ✅ Пост содержит: заголовок, краткое содержание, ключевые моменты, призыв к действию
- ✅ Пост содержит эмодзи и хештеги
- ✅ Длина поста оптимальна для Telegram

**Проверка форматирования:**
- ✅ Пост структурирован и привлекателен
- ✅ Используются эмодзи
- ✅ Есть хештеги
- ✅ Длина подходит для Telegram

---

#### Тест 4: Обработка ошибок - отсутствие API ключа

**Предварительные условия:**
- API ключ OpenRouter НЕ настроен (временно удалить из .env.local)

**Шаги:**
1. Ввести валидный URL статьи
2. Нажать любую из кнопок AI-обработки

**Ожидаемый результат:**
- ✅ Отображается информативное сообщение об ошибке
- ✅ Сообщение содержит инструкции по настройке API ключа
- ✅ Упоминается .env.local для локальной разработки и Vercel для продакшена

---

#### Тест 5: Обработка ошибок - неверный URL

**Предварительные условия:**
- API ключ настроен

**Шаги:**
1. Ввести неверный URL (например, "не-url")
2. Нажать любую из кнопок

**Ожидаемый результат:**
- ✅ Отображается предупреждение "Пожалуйста, введите корректный URL"
- ✅ Запрос не отправляется

---

#### Тест 6: Обработка ошибок - пустая статья

**Предварительные условия:**
- API ключ настроен
- URL указывает на страницу без контента или с очень коротким контентом (< 50 символов)

**Шаги:**
1. Ввести URL статьи с пустым контентом
2. Нажать любую из кнопок AI-обработки

**Ожидаемый результат:**
- ✅ Отображается сообщение об ошибке
- ✅ Сообщение указывает, что содержимое статьи слишком короткое или отсутствует

---

#### Тест 7: Обработка ошибок - недостаточно средств на счету

**Предварительные условия:**
- API ключ настроен, но на счету OpenRouter недостаточно средств

**Шаги:**
1. Ввести валидный URL статьи
2. Нажать любую из кнопок AI-обработки

**Ожидаемый результат:**
- ✅ Отображается информативное сообщение об ошибке
- ✅ Сообщение содержит ссылку на пополнение баланса: https://openrouter.ai/credits

---

#### Тест 8: Обработка ошибок - превышен лимит контекста

**Предварительные условия:**
- API ключ настроен
- URL указывает на очень длинную статью (> 200k символов для AI-обработки)

**Шаги:**
1. Ввести URL очень длинной статьи
2. Нажать любую из кнопок AI-обработки

**Ожидаемый результат:**
- ✅ Статья автоматически обрезается до допустимого размера
- ✅ В результате отображается предупреждение об обрезке
- ✅ Указывается, сколько символов было обработано из общего количества

---

#### Тест 9: Проверка форматирования результатов

**Предварительные условия:**
- Все три функции работают корректно

**Проверка:**
- ✅ Результаты отображаются в читаемом формате
- ✅ Для тезисов и поста Telegram используется соответствующее форматирование
- ✅ Нет лишних технических символов или артефактов
- ✅ Текст правильно отформатирован (переносы строк, абзацы)

---

### 4.2. Интеграционное тестирование

#### Тест 10: Полный поток - парсинг → AI-обработка

**Предварительные условия:**
- API ключ настроен
- Статья еще не распарсена

**Шаги:**
1. Ввести валидный URL статьи
2. Нажать кнопку "О чем статья?"
3. Наблюдать за процессом

**Ожидаемый результат:**
- ✅ Сначала отображается "Парсинг..." в индикаторе загрузки
- ✅ После парсинга автоматически начинается AI-обработка
- ✅ Отображается "О чем статья?" в индикаторе загрузки
- ✅ В результате появляется описание статьи
- ✅ Нет ошибок в консоли браузера

---

#### Тест 11: Работа всех трех кнопок последовательно

**Предварительные условия:**
- API ключ настроен
- Статья распарсена

**Шаги:**
1. Ввести валидный URL статьи
2. Нажать "О чем статья?" → дождаться результата
3. Нажать "Тезисы" → дождаться результата
4. Нажать "Пост для Telegram" → дождаться результата

**Ожидаемый результат:**
- ✅ Все три кнопки работают корректно
- ✅ Каждая кнопка возвращает соответствующий результат
- ✅ Результаты не перекрывают друг друга
- ✅ Состояние загрузки корректно обновляется

---

#### Тест 12: Состояние загрузки и отображение результатов

**Предварительные условия:**
- API ключ настроен

**Проверка состояний:**
- ✅ При загрузке отображается спиннер
- ✅ Отображается текст "Генерация ответа..." или "Парсинг статьи..."
- ✅ Отображается название активной кнопки
- ✅ Кнопки блокируются во время загрузки
- ✅ После завершения загрузки состояние корректно сбрасывается
- ✅ Результат отображается в блоке результатов

---

#### Тест 13: Кнопка "Копировать"

**Предварительные условия:**
- Есть результат в блоке результатов

**Шаги:**
1. Получить любой результат (перевод, описание, тезисы или пост)
2. Нажать кнопку "Копировать"

**Ожидаемый результат:**
- ✅ Текст копируется в буфер обмена
- ✅ Кнопка временно меняется на "Скопировано!"
- ✅ Кнопка меняет цвет на зеленый
- ✅ Через 2 секунды кнопка возвращается в исходное состояние

---

#### Тест 14: Изменение URL

**Предварительные условия:**
- Есть распарсенная статья и результат

**Шаги:**
1. Изменить URL в поле ввода

**Ожидаемый результат:**
- ✅ Состояние `parsedSuccessfully` сбрасывается
- ✅ `parsedArticle` очищается
- ✅ Результат очищается
- ✅ `currentActionType` сбрасывается

---

#### Тест 15: Кнопка "Перевести"

**Предварительные условия:**
- API ключ настроен

**Шаги:**
1. Ввести валидный URL статьи
2. Нажать кнопку "Перевести"

**Ожидаемый результат:**
- ✅ Статья автоматически парсится (если не была распарсена)
- ✅ Отображается индикатор загрузки "Парсинг..." затем "Перевод..."
- ✅ В результате появляется перевод статьи на русский язык
- ✅ Перевод содержит только текст без комментариев и объяснений
- ✅ Если текст был обрезан, отображается предупреждение

---

## Чеклист готовности

### Функциональность
- [x] Все три кнопки AI-обработки работают
- [x] Кнопка "Перевести" работает
- [x] Автоматический парсинг перед AI-обработкой
- [x] Кнопка "Копировать" работает

### Обработка ошибок
- [x] Обработка отсутствия API ключа
- [x] Обработка неверного URL
- [x] Обработка пустой статьи
- [x] Обработка недостатка средств
- [x] Обработка превышения лимита контекста
- [x] Обработка ошибок парсинга

### UX
- [x] Индикаторы загрузки работают
- [x] Состояния кнопок корректны
- [x] Результаты отображаются правильно
- [x] Форматирование результатов корректно

### Валидация
- [x] Валидация входных данных на бэкенде
- [x] Валидация URL на фронтенде
- [x] Валидация распарсенных данных

### Логирование
- [x] Ошибки логируются в консоль
- [x] Логи содержат полезную информацию

## Рекомендации по тестированию

1. **Тестирование с реальными статьями:**
   - Использовать статьи разной длины
   - Тестировать с разными типами контента (текст, код, таблицы)

2. **Тестирование производительности:**
   - Проверить время обработки длинных статей
   - Проверить поведение при медленном интернете

3. **Тестирование граничных случаев:**
   - Очень короткие статьи (< 100 символов)
   - Очень длинные статьи (> 500k символов)
   - Статьи с нестандартными символами
   - Статьи на разных языках (не английский)

4. **Тестирование в разных браузерах:**
   - Chrome
   - Firefox
   - Safari
   - Edge

## Статус тестирования

✅ **Этап 4 выполнен**

Все компоненты реализованы и готовы к тестированию. Код проверен на:
- Логические ошибки
- Обработку ошибок
- Валидацию данных
- Соответствие требованиям плана

Рекомендуется провести ручное тестирование с реальными статьями для финальной проверки.






